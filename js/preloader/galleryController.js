import{calcWinsize,getRandomInteger}from"./utils.js";import GalleryItem from"./galleryItem.js";gsap.registerPlugin(SplitText);const splitchars=document.querySelectorAll(".split-chars");splitchars.forEach((t=>{new SplitText(t,{type:"chars",charsClass:"char"})}));let winsize=calcWinsize();window.addEventListener("resize",(()=>winsize=calcWinsize()));const overlayRows=[...document.querySelectorAll(".overlay__row")];export default class GalleryController{constructor(t){this.DOM={galleryEl:t,title:document.querySelector(".title-uzi")},this.DOM.titleChars=this.DOM.title.querySelectorAll(".char"),this.titleCharsTotal=this.DOM.titleChars.length,this.DOM.galleryItemElems=[...this.DOM.galleryEl.querySelectorAll(".gallery__item")],this.galleryItems=[],this.DOM.galleryItemElems.forEach((t=>this.galleryItems.push(new GalleryItem(t)))),this.itemsTotal=this.galleryItems.length,this.intro()}intro(){const t=gsap.timeline().to(this.DOM.title,{duration:1,ease:"expo",startAt:{y:"10%"},y:"0%",opacity:1},0);for(const[e,i]of this.galleryItems.entries())t.set(i.DOM.img,{x:winsize.width/2-i.imgRect.left-i.imgRect.width/2,y:winsize.height/2-i.imgRect.top-i.imgRect.height/2,scale:1.6,rotation:getRandomInteger(-10,10),opacity:1,delay:.2*e},0),0===e&&t.set(i.DOM.imgInner,{scale:1.8},0);const[e,...i]=this.galleryItems.map((t=>t.DOM.img));t.addLabel("startAnimation","+=0").add((()=>{document.body.classList.remove("noscroll")}),"startAnimation").to(this.DOM.titleChars,{duration:1,ease:"expo",x:(t,e)=>-40*(Math.floor(this.titleCharsTotal/2)-t),opacity:0,stagger:{from:"center"}},"startAnimation").to(i,{duration:1,ease:"power3",x:()=>"+="+getRandomInteger(-200,200)+"%",y:()=>"+="+getRandomInteger(-200,200)+"%",opacity:0,rotation:()=>getRandomInteger(-20,20)},"startAnimation").to(i,{duration:.5,ease:"expo",startAt:{x:0,y:0,rotation:0,scale:.8},scale:1,opacity:1}).to(e,{duration:1.2,ease:"expo",x:0,y:0,scale:1,rotation:0,opacity:1},"startAnimation+=0.2").to(this.galleryItems[0].DOM.imgInner,{duration:1.2,ease:"expo",scale:1},"startAnimation").addLabel("grid","start+=0.1").to(overlayRows,{ease:"expo3.in",duration:1,scaleX:0},"grid").to(i,{duration:.5,ease:"expo2",opacity:0},"grid+=0.51").to(e,{duration:.5,ease:"expo2",opacity:0},"grid+=0.51").to(".preloader",{opacity:0,zIndex:-1,display:"none",duration:.1,ease:"power1"})}}