import{calcWinsize,getRandomInteger}from"./utils.js";import GalleryItem from"./galleryItem.js";let winsize=calcWinsize();window.addEventListener("resize",(()=>winsize=calcWinsize()));const overlayRows=[...document.querySelectorAll(".overlay__row")];export default class GalleryController{constructor(e){this.DOM={galleryEl:e,title:document.querySelector(".title-uzi")},this.DOM.galleryItemElems=[...this.DOM.galleryEl.querySelectorAll(".gallery__item")],this.galleryItems=[],this.DOM.galleryItemElems.forEach((e=>this.galleryItems.push(new GalleryItem(e)))),this.itemsTotal=this.galleryItems.length,this.intro()}intro(){const e=gsap.timeline();for(const[t,i]of this.galleryItems.entries())e.set(i.DOM.img,{x:winsize.width/2-i.imgRect.left-i.imgRect.width/2,y:winsize.height/2-i.imgRect.top-i.imgRect.height/2,scale:1.6,rotation:getRandomInteger(-10,10),opacity:1,delay:.2*t},0),0===t&&e.set(i.DOM.imgInner,{scale:1.8},0);const[t,...i]=this.galleryItems.map((e=>e.DOM.img));e.addLabel("startAnimation","+=0").add((()=>{document.body.classList.remove("noscroll")}),"startAnimation").to(i,{duration:1,ease:"power3",x:()=>"+="+getRandomInteger(-200,200)+"%",y:()=>"+="+getRandomInteger(-200,200)+"%",opacity:0,rotation:()=>getRandomInteger(-20,20)},"startAnimation").to(i,{duration:.5,ease:"expo",startAt:{x:0,y:0,rotation:0,scale:.8},scale:1,opacity:1}).to(t,{duration:1.2,ease:"expo",x:0,y:0,scale:1,rotation:0,opacity:1},"startAnimation+=0.2").to(this.galleryItems[0].DOM.imgInner,{duration:1.2,ease:"expo",scale:1},"startAnimation").addLabel("grid","start+=0.1").to(overlayRows,{ease:"expo3.in",duration:1,scaleX:0},"grid").to(i,{duration:.5,ease:"expo2",opacity:0},"grid+=0.51").to(t,{duration:.5,ease:"expo2",opacity:0},"grid+=0.51").to(".preloader",{opacity:0,zIndex:-1,display:"none",duration:.1,ease:"power1"})}}